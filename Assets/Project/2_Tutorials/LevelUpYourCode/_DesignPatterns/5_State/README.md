# ğŸ® State Pattern (ìŠ¤í…Œì´íŠ¸ íŒ¨í„´)

## ğŸ“‹ ëª©ì°¨
- [íŒ¨í„´ ê°œìš”](#-íŒ¨í„´-ê°œìš”)
- [ì™œ State Patternì´ í•„ìš”í•œê°€?](#-ì™œ-state-patternì´-í•„ìš”í•œê°€)
- [í•µì‹¬ êµ¬ì„±ìš”ì†Œ](#-í•µì‹¬-êµ¬ì„±ìš”ì†Œ)
- [ì½”ë“œ êµ¬ì¡°](#-ì½”ë“œ-êµ¬ì¡°)
- [ì‹¤í–‰ íë¦„](#-ì‹¤í–‰-íë¦„)
- [ì£¼ìš” ì½”ë“œ ë¶„ì„](#-ì£¼ìš”-ì½”ë“œ-ë¶„ì„)
- [ì¥ë‹¨ì ](#-ì¥ë‹¨ì )
- [ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€](#-ì‹¤ì œ-ì‚¬ìš©-ì‚¬ë¡€)
- [ì‹¤ë¬´ í™•ì¥ ê°€ì´ë“œ](#-ì‹¤ë¬´-í™•ì¥-ê°€ì´ë“œ)
- [í•™ìŠµ ì •ë¦¬](#-í•™ìŠµ-ì •ë¦¬)

---

## ğŸ¯ íŒ¨í„´ ê°œìš”

**State Pattern**ì€ **í–‰ë™ íŒ¨í„´(Behavioral Pattern)** ì¤‘ í•˜ë‚˜ë¡œ, ê°ì²´ì˜ ë‚´ë¶€ ìƒíƒœì— ë”°ë¼ í–‰ë™ì„ ë³€ê²½í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.

ìƒíƒœë¥¼ ë³„ë„ì˜ í´ë˜ìŠ¤ë¡œ ìº¡ìŠí™”í•˜ì—¬, ìƒíƒœ ì „í™˜ ì‹œ ê°ì²´ì˜ í–‰ë™ì´ ìë™ìœ¼ë¡œ ë°”ë€Œê²Œ í•©ë‹ˆë‹¤.

### ğŸ“Œ í•µì‹¬ ê°œë…

```
ê°ì²´ì˜ "ìƒíƒœ"ë¥¼ ë³„ë„ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬í•˜ì—¬
ìƒíƒœì— ë”°ë¼ í–‰ë™ì´ ë‹¬ë¼ì§€ê²Œ í•œë‹¤!
```

**ì¼ë°˜ì ì¸ ë°©ë²• :**
```csharp
// switchë¬¸ìœ¼ë¡œ ìƒíƒœ ë¶„ê¸°
switch (state)
{
    case PlayerState.Idle:
        Idle();
        break;
    case PlayerState.Walk:
        Walk();
        break;
    case PlayerState.Jump:
        Jump();
        break;
}
// âŒ ë¬¸ì œ : ìƒíƒœ ì¶”ê°€ ì‹œë§ˆë‹¤ case ì¶”ê°€, í™•ì¥ ì–´ë ¤ì›€
```

**State Pattern :**
```csharp
// í˜„ì¬ ìƒíƒœ ê°ì²´ì—ê²Œ ìœ„ì„
currentState.Execute();
// âœ… ì¥ì  : ìƒíƒœ ì¶”ê°€ ì‹œ ìƒˆ í´ë˜ìŠ¤ë§Œ ìƒì„±, OCP ì¤€ìˆ˜!
```

---

## ğŸ¤” ì™œ State Patternì´ í•„ìš”í•œê°€?

### ë¬¸ì œ ìƒí™©

ê²Œì„ì—ì„œ í”Œë ˆì´ì–´ì˜ ìƒíƒœ(ëŒ€ê¸°, ê±·ê¸°, ì í”„)ë¥¼ ê´€ë¦¬í•  ë•Œ, ì¼ë°˜ì ìœ¼ë¡œ ì´ë ‡ê²Œ ì‘ì„±í•©ë‹ˆë‹¤ :

```csharp
public class UnrefactoredPlayerController : MonoBehaviour
{
    private PlayerControllerState state;

    private void Update()
    {
        GetInput();

        switch (state)
        {
            case PlayerControllerState.Idle:
                Idle();
                break;
            case PlayerControllerState.Walk:
                Walk();
                break;
            case PlayerControllerState.Jump:
                Jump();
                break;
        }
    }
}
```

**ì´ ì½”ë“œì˜ ë¬¸ì œì  :**

âŒ **í™•ì¥ ì–´ë ¤ì›€ (OCP ìœ„ë°˜)**
   - ìƒˆë¡œìš´ ìƒíƒœ(Dash, Climb, Swim ë“±) ì¶”ê°€ ì‹œ switchë¬¸ ìˆ˜ì • í•„ìš”
   - ìƒíƒœê°€ ë§ì•„ì§ˆìˆ˜ë¡ ì½”ë“œê°€ ë¹„ëŒ€í•´ì§

âŒ **ë‹¨ì¼ ì±…ì„ ìœ„ë°˜ (SRP ìœ„ë°˜)**
   - í•˜ë‚˜ì˜ í´ë˜ìŠ¤ê°€ ëª¨ë“  ìƒíƒœì˜ ë¡œì§ì„ ê´€ë¦¬
   - ê´€ë ¨ ì—†ëŠ” ìƒíƒœì˜ ì½”ë“œê°€ í•œ ê³³ì— ë’¤ì„ì„

âŒ **ìƒíƒœ ì „í™˜ ë¡œì§ ì‚°ì¬**
   - ì „í™˜ ì¡°ê±´ì´ ì—¬ëŸ¬ ê³³ì— í©ì–´ì ¸ ê´€ë¦¬ ì–´ë ¤ì›€
   - ë²„ê·¸ ë°œìƒ ì‹œ ì¶”ì ì´ ì–´ë ¤ì›€

âŒ **ì¬ì‚¬ìš© ë¶ˆê°€ëŠ¥**
   - íŠ¹ì • ìƒíƒœì˜ ë¡œì§ë§Œ ì¬ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ
   - ë¹„ìŠ·í•œ ìƒíƒœë¥¼ ë‹¤ë¥¸ ê°ì²´ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ ë³µì‚¬ í•„ìš”

### State Patternì˜ í•´ê²°ì±…

âœ… **ìƒíƒœë³„ í´ë˜ìŠ¤ ë¶„ë¦¬**
   - ê° ìƒíƒœê°€ ë…ë¦½ëœ í´ë˜ìŠ¤ë¡œ ìº¡ìŠí™”
   - ìƒíƒœë³„ ë¡œì§ì´ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬ë¨

âœ… **ì‰¬ìš´ í™•ì¥ (OCP ì¤€ìˆ˜)**
   - ìƒˆë¡œìš´ ìƒíƒœ ì¶”ê°€ ì‹œ ìƒˆ í´ë˜ìŠ¤ë§Œ ìƒì„±
   - ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”

âœ… **ìƒíƒœ ì „í™˜ ë¡œì§ ì§‘ì¤‘**
   - StateMachineì´ ì „í™˜ì„ ì¤‘ì•™ì—ì„œ ê´€ë¦¬
   - Enter/Exit ì½œë°±ìœ¼ë¡œ ì „í™˜ ì‹œ ì´ˆê¸°í™”/ì •ë¦¬ ìë™í™”

âœ… **ë‹¨ì¼ ì±…ì„ ì¤€ìˆ˜ (SRP)**
   - ê° State í´ë˜ìŠ¤ëŠ” ìê¸° ìƒíƒœì˜ ë¡œì§ë§Œ ë‹´ë‹¹
   - ê¹”ë”í•œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬

---

## ğŸ—ï¸ í•µì‹¬ êµ¬ì„±ìš”ì†Œ

State Patternì€ ë‹¤ìŒ 4ê°€ì§€ í•µì‹¬ ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤ :

### 1ï¸âƒ£ State Interface (ìƒíƒœ ì¸í„°í˜ì´ìŠ¤)

**ğŸ“ íŒŒì¼ :** [IState.cs](./Scripts/Pattern/SimpleStateMachine/IState.cs)

```csharp
public interface IState : IColorable
{
    public void Enter()
    {
        // ìƒíƒœì— ì²˜ìŒ ì§„ì…í•  ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ
    }

    public void Execute()
    {
        // ë§¤ í”„ë ˆì„ ì‹¤í–‰ë˜ëŠ” ë¡œì§, ìƒˆë¡œìš´ ìƒíƒœë¡œ ì „í™˜í•˜ëŠ” ì¡°ê±´ í¬í•¨
    }

    public void Exit()
    {
        // ìƒíƒœì—ì„œ ë¹ ì ¸ë‚˜ê°ˆ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ
    }
}
```

**ì—­í•  :**
- ëª¨ë“  ìƒíƒœê°€ ë”°ë¼ì•¼ í•  í‘œì¤€ ì¸í„°í˜ì´ìŠ¤
- `Enter()` : ìƒíƒœ ì§„ì… ì‹œ ì´ˆê¸°í™”
- `Execute()` : ë§¤ í”„ë ˆì„ ì‹¤í–‰ë˜ëŠ” ë¡œì§
- `Exit()` : ìƒíƒœ ì´íƒˆ ì‹œ ì •ë¦¬

---

### 2ï¸âƒ£ Concrete State (êµ¬ì²´ì ì¸ ìƒíƒœ)

**ğŸ“ íŒŒì¼ :**
- [IdleState.cs](./Scripts/Pattern/SimpleStateMachine/States/IdleState.cs)
- [WalkState.cs](./Scripts/Pattern/SimpleStateMachine/States/WalkState.cs)
- [JumpState.cs](./Scripts/Pattern/SimpleStateMachine/States/JumpState.cs)

```csharp
public class IdleState : IState
{
    private PlayerController player;

    public IdleState(PlayerController player)
    {
        this.player = player;
    }

    public void Execute()
    {
        // ë°”ë‹¥ì— ë‹¿ì§€ ì•Šìœ¼ë©´ ì í”„ ìƒíƒœë¡œ ì „í™˜
        if (!player.IsGrounded)
        {
            player.PlayerStateMachine.TransitionTo(player.PlayerStateMachine.jumpState);
        }

        // ìµœì†Œ ì„ê³„ê°’ ì´ìƒìœ¼ë¡œ ì´ë™í•˜ë©´ ê±·ê¸° ìƒíƒœë¡œ ì „í™˜
        if (Mathf.Abs(player.CharController.velocity.x) > 0.1f ||
            Mathf.Abs(player.CharController.velocity.z) > 0.1f)
        {
            player.PlayerStateMachine.TransitionTo(player.PlayerStateMachine.walkState);
        }
    }
}
```

**ì—­í•  :**
- `IState`ë¥¼ êµ¬í˜„í•œ ì‹¤ì œ ìƒíƒœ í´ë˜ìŠ¤
- ê° ìƒíƒœë§Œì˜ í–‰ë™ ë¡œì§ ì •ì˜
- ìƒíƒœ ì „í™˜ ì¡°ê±´ íŒë‹¨ ë° ìš”ì²­

---

### 3ï¸âƒ£ State Machine (ìƒíƒœ ë¨¸ì‹ )

**ğŸ“ íŒŒì¼ :** [SimplePlayerStateMachine.cs](./Scripts/Pattern/SimpleStateMachine/SimplePlayerStateMachine.cs)

```csharp
public class SimplePlayerStateMachine
{
    public IState CurrentState { get; private set; }

    // ìƒíƒœ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°
    public WalkState walkState;
    public JumpState jumpState;
    public IdleState idleState;

    // ìƒíƒœ ë³€ê²½ì„ ë‹¤ë¥¸ ê°ì²´ì— ì•Œë¦¬ê¸° ìœ„í•œ ì´ë²¤íŠ¸
    public event Action<IState> stateChanged;

    // í˜„ì¬ ìƒíƒœë¥¼ ì¢…ë£Œí•˜ê³  ë‹¤ë¥¸ ìƒíƒœë¡œ ì§„ì…
    public void TransitionTo(IState nextState)
    {
        CurrentState.Exit();
        CurrentState = nextState;
        nextState.Enter();

        // ë‹¤ë¥¸ ê°ì²´ì— ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŒì„ ì•Œë¦¼
        stateChanged?.Invoke(nextState);
    }
}
```

**ì—­í•  :**
- í˜„ì¬ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê³  ìƒíƒœ ì „í™˜ì„ ì²˜ë¦¬í•˜ëŠ” **"êµí†µ ì •ë¦¬ ë‹´ë‹¹ì"**
- Stateë“¤ì´ ì§ì ‘ ì„œë¡œë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³ , **ë°˜ë“œì‹œ StateMachineì„ í†µí•´ì„œ** ì „í™˜
- ì „í™˜ ì‹œ Exit â†’ êµì²´ â†’ Enter ìˆœì„œ ë³´ì¥
- `stateChanged` ì´ë²¤íŠ¸ë¡œ ì™¸ë¶€ì— ìƒíƒœ ë³€ê²½ ì•Œë¦¼ (ì˜µì €ë²„ íŒ¨í„´ í™œìš©)

**StateMachineì„ ê±°ì¹˜ëŠ” ì´ìœ  :**

ì „í™˜ ë¡œì§ì´ í•œ ê³³ì— ì§‘ì¤‘ë˜ì–´ ìˆìœ¼ë¯€ë¡œ, ë‚˜ì¤‘ì— ì „í™˜ ì‹œ ë¡œê·¸ë¥¼ ì°ê±°ë‚˜, ì „í™˜ ì¡°ê±´ì„ ì¶”ê°€í•˜ê±°ë‚˜, ì „í™˜ íš¨ê³¼ë¥¼ ë„£ì„ ë•Œ **StateMachineë§Œ ìˆ˜ì •**í•˜ë©´ ë©ë‹ˆë‹¤.

```
IdleState â†’ player.PlayerStateMachine.TransitionTo(jumpState)
                         â”‚
                         â–¼
              StateMachineì´ ì²˜ë¦¬ :
              1. í˜„ì¬ ìƒíƒœ.Exit()     â† ì •ë¦¬
              2. CurrentState = ë‹¤ìŒ  â† êµì²´
              3. ë‹¤ìŒ ìƒíƒœ.Enter()    â† ì´ˆê¸°í™”
              4. stateChanged ì´ë²¤íŠ¸  â† UI ë“±ì— ì•Œë¦¼
```

---

### 4ï¸âƒ£ Context (ì»¨í…ìŠ¤íŠ¸ / ì†Œìœ ì)

**ğŸ“ íŒŒì¼ :** [PlayerController.cs](./Scripts/ExampleUsage/PlayerController.cs)

```csharp
public class PlayerController : MonoBehaviour
{
    private SimplePlayerStateMachine playerStateMachine;

    private void Awake()
    {
        // ìƒíƒœ ë¨¸ì‹  ì´ˆê¸°í™”
        playerStateMachine = new SimplePlayerStateMachine(this);
    }

    private void Start()
    {
        playerStateMachine.Initialize(playerStateMachine.idleState);
    }

    private void Update()
    {
        // í˜„ì¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        playerStateMachine.Execute();
    }
}
```

**ì—­í•  :**
- StateMachineì„ ì†Œìœ í•˜ê³  ë§¤ í”„ë ˆì„ ì—…ë°ì´íŠ¸ í˜¸ì¶œ
- ìƒíƒœë“¤ì´ ì°¸ì¡°í•˜ëŠ” ë°ì´í„° ì œê³µ (IsGrounded, CharController ë“±)
- ê²Œì„ ì˜¤ë¸Œì íŠ¸ì™€ StateMachineì„ ì—°ê²°í•˜ëŠ” ë‹¤ë¦¬ ì—­í• 

---

## ğŸ“Š ì½”ë“œ êµ¬ì¡°

### í´ë” êµ¬ì¡°

```
5_State/
â”œâ”€â”€ Scripts/
â”‚   â”œâ”€â”€ Pattern/                              (íŒ¨í„´ êµ¬í˜„ í”„ë ˆì„)
â”‚   â”‚   â””â”€â”€ SimpleStateMachine/
â”‚   â”‚       â”œâ”€â”€ IState.cs                    â† ìƒíƒœ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚       â”œâ”€â”€ IColorable.cs                â† ìƒ‰ìƒ ë³€ê²½ ì¸í„°í˜ì´ìŠ¤ (ì˜ˆì œìš©)
â”‚   â”‚       â”œâ”€â”€ SimplePlayerStateMachine.cs  â† ìƒíƒœ ë¨¸ì‹  (êµí†µ ì •ë¦¬ ë‹´ë‹¹ì)
â”‚   â”‚       â””â”€â”€ States/
â”‚   â”‚           â”œâ”€â”€ IdleState.cs             â† ëŒ€ê¸° ìƒíƒœ
â”‚   â”‚           â”œâ”€â”€ WalkState.cs             â† ê±·ê¸° ìƒíƒœ
â”‚   â”‚           â””â”€â”€ JumpState.cs             â† ì í”„ ìƒíƒœ
â”‚   â”‚
â”‚   â”œâ”€â”€ ExampleUsage/                        (ì‚¬ìš© ì˜ˆì‹œ)
â”‚   â”‚   â”œâ”€â”€ PlayerController.cs              â† Context (ìƒíƒœ ë¨¸ì‹  ì†Œìœ ì)
â”‚   â”‚   â”œâ”€â”€ PlayerInput.cs                   â† ì…ë ¥ ì²˜ë¦¬
â”‚   â”‚   â””â”€â”€ PlayerStateView.cs              â† UI ë° ìƒ‰ìƒ ë³€ê²½ (ì˜µì €ë²„)
â”‚   â”‚
â”‚   â””â”€â”€ Unrefactored/                        (ë¦¬íŒ©í† ë§ ì „ ë¹„êµìš©)
â”‚       â””â”€â”€ UnrefactoredPlayerController.cs  â† âŒ switchë¬¸ ë°©ì‹ (ì•ˆí‹°íŒ¨í„´)
â”‚
â””â”€â”€ README.md                                 â† ğŸ“ í˜„ì¬ ë¬¸ì„œ
```

### í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        IState             â”‚  â† ì¸í„°í˜ì´ìŠ¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + Enter()                â”‚
â”‚ + Execute()              â”‚
â”‚ + Exit()                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–³
            â”‚ implements
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       â”‚       â”‚
    â–¼       â–¼       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Idle    â”‚ â”‚Walk    â”‚ â”‚Jump    â”‚  â† Concrete States
â”‚State   â”‚ â”‚State   â”‚ â”‚State   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚           â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ uses
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SimplePlayerStateMachine â”‚  â† State Machine
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + CurrentState           â”‚
â”‚ + walkState              â”‚
â”‚ + jumpState              â”‚
â”‚ + idleState              â”‚
â”‚ + event stateChanged     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + Initialize()           â”‚
â”‚ + TransitionTo()         â”‚
â”‚ + Execute()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–³
                â”‚ owns
                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    PlayerController      â”‚  â† Context
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + CharController         â”‚
â”‚ + IsGrounded             â”‚
â”‚ + PlayerStateMachine     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Awake()                â”‚
â”‚ - Update()               â”‚
â”‚ - Move()                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìŠ¤í¬ë¦½íŠ¸ ì˜ì¡´ ê´€ê³„

ì´ í”„ë¡œì íŠ¸ì˜ ìŠ¤í¬ë¦½íŠ¸ë“¤ì€ **ìˆœí™˜ ì°¸ì¡° êµ¬ì¡°**ë¡œ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤ :

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PlayerInput                          â”‚
â”‚              (í‚¤ë³´ë“œ ì…ë ¥ ì²˜ë¦¬)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ ì…ë ¥ ë²¡í„° ì œê³µ
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PlayerController                        â”‚
â”‚          (í”Œë ˆì´ì–´ ì´ë™, ì í”„, ë¬¼ë¦¬)                       â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚      SimplePlayerStateMachine               â”‚       â”‚
â”‚   â”‚          (ìƒíƒœ ì „í™˜ ê´€ë¦¬ì)                    â”‚       â”‚
â”‚   â”‚                                             â”‚       â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚
â”‚   â”‚   â”‚ IdleState â”‚ â”‚WalkState â”‚ â”‚JumpState â”‚  â”‚       â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                      â”‚ stateChanged ì´ë²¤íŠ¸               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PlayerStateView                         â”‚
â”‚         (UI í…ìŠ¤íŠ¸ + ë©”ì‹œ ìƒ‰ìƒ ë³€ê²½)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ì—°ê²° ê³ ë¦¬ :**

```
â‘  PlayerControllerê°€ ìƒì„± ì‹œ SimplePlayerStateMachineì„ ë§Œë“ ë‹¤
         â”‚
         â–¼
â‘¡ SimplePlayerStateMachineì´ ìƒì„±ìì—ì„œ 3ê°œ Stateë¥¼ ë§Œë“ ë‹¤
   this.walkState = new WalkState(player);  â†â”€â”€ player ì°¸ì¡°ë¥¼ ë„˜ê¹€
   this.jumpState = new JumpState(player);
   this.idleState = new IdleState(player);
         â”‚
         â–¼
â‘¢ ê° State ì•ˆì—ì„œ playerë¥¼ í†µí•´ ë‹¤ì‹œ StateMachineì— ì ‘ê·¼í•œë‹¤
   player.PlayerStateMachine.TransitionTo(...)  â†â”€â”€ ìˆœí™˜ ì°¸ì¡°!
```

```
PlayerController â”€â”€ì†Œìœ â”€â”€â–¶ StateMachine â”€â”€ì†Œìœ â”€â”€â–¶ Stateë“¤
       â–²                                          â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ player ì°¸ì¡°ë¡œ ì ‘ê·¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ì‹¤í–‰ íë¦„

### 1ï¸âƒ£ ì´ˆê¸°í™” íë¦„

```
[ê²Œì„ ì‹œì‘]
    â¬‡ï¸
PlayerController.Awake()
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ StateMachine ìƒì„±                  â”‚
â”‚   new SimplePlayerStateMachine(this) â”‚
â”‚                                   â”‚
â”‚   ë‚´ë¶€ì—ì„œ 3ê°œ ìƒíƒœ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± :   â”‚
â”‚   â”œâ”€â”€ new WalkState(player)       â”‚
â”‚   â”œâ”€â”€ new JumpState(player)       â”‚
â”‚   â””â”€â”€ new IdleState(player)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â¬‡ï¸
PlayerController.Start()
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ˆê¸° ìƒíƒœ ì„¤ì •                     â”‚
â”‚   Initialize(idleState)           â”‚
â”‚   â”œâ”€â”€ CurrentState = idleState    â”‚
â”‚   â”œâ”€â”€ idleState.Enter()           â”‚
â”‚   â””â”€â”€ stateChanged ì´ë²¤íŠ¸ ë°œí–‰     â”‚
â”‚       â†’ PlayerStateViewê°€ ìˆ˜ì‹ !   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â¬‡ï¸
âœ… ì´ˆê¸°í™” ì™„ë£Œ! IdleStateë¡œ ì‹œì‘
```

---

### 2ï¸âƒ£ ë§¤ í”„ë ˆì„ ì—…ë°ì´íŠ¸ íë¦„

```
[ë§¤ í”„ë ˆì„]
    â¬‡ï¸
PlayerController.Update()
    â¬‡ï¸
playerStateMachine.Execute()
    â¬‡ï¸
CurrentState.Execute()  â† í˜„ì¬ ìƒíƒœì˜ ë¡œì§ ì‹¤í–‰
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì˜ˆ : IdleState.Execute()         â”‚
â”‚                                   â”‚
â”‚   if (!player.IsGrounded)         â”‚
â”‚       â†’ JumpStateë¡œ ì „í™˜!         â”‚
â”‚                                   â”‚
â”‚   if (velocity > 0.1f)            â”‚
â”‚       â†’ WalkStateë¡œ ì „í™˜!         â”‚
â”‚                                   â”‚
â”‚   (ë‘˜ ë‹¤ ì•„ë‹ˆë©´ IdleState ìœ ì§€)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3ï¸âƒ£ ìƒíƒœ ì „í™˜ íë¦„

```
[ìƒíƒœ ì „í™˜ ìš”ì²­]
    â¬‡ï¸
StateMachine.TransitionTo(nextState)
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. CurrentState.Exit()            â”‚
â”‚    â†’ í˜„ì¬ ìƒíƒœ ì •ë¦¬               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. CurrentState = nextState       â”‚
â”‚    â†’ ìƒíƒœ êµì²´                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. nextState.Enter()              â”‚
â”‚    â†’ ìƒˆ ìƒíƒœ ì´ˆê¸°í™”               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. stateChanged?.Invoke(nextState) â”‚
â”‚    â†’ êµ¬ë…ì(PlayerStateView)ì—ê²Œ   â”‚
â”‚      ìƒíƒœ ë³€ê²½ ì•Œë¦¼!               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PlayerStateView.OnStateChanged()  â”‚
â”‚   â”œâ”€â”€ UI í…ìŠ¤íŠ¸ ë³€ê²½              â”‚
â”‚   â”œâ”€â”€ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½            â”‚
â”‚   â””â”€â”€ ë©”ì‹œ ìƒ‰ìƒ ë³€ê²½              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» ì£¼ìš” ì½”ë“œ ë¶„ì„

### ğŸ“Œ í•µì‹¬ ì½”ë“œ 1 : ìƒíƒœ ì¸í„°í˜ì´ìŠ¤ (IState)

**ìœ„ì¹˜ :** IState.cs:7-23

```csharp
public interface IState : IColorable
{
    public void Enter()
    {
        // ìƒíƒœì— ì²˜ìŒ ì§„ì…í•  ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ
    }

    public void Execute()
    {
        // ë§¤ í”„ë ˆì„ ì‹¤í–‰ë˜ëŠ” ë¡œì§, ìƒˆë¡œìš´ ìƒíƒœë¡œ ì „í™˜í•˜ëŠ” ì¡°ê±´ í¬í•¨
    }

    public void Exit()
    {
        // ìƒíƒœì—ì„œ ë¹ ì ¸ë‚˜ê°ˆ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ
    }
}
```

**ì´í•´ í¬ì¸íŠ¸ :**
- C# 8.0ì˜ **ë””í´íŠ¸ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„** ì‚¬ìš©
- ëª¨ë“  ìƒíƒœì˜ ìƒëª…ì£¼ê¸° : Enter â†’ Execute (ë°˜ë³µ) â†’ Exit
- `IColorable` ìƒì†ì€ ì˜ˆì œìš© (ë©”ì‹œ ìƒ‰ìƒ ë³€ê²½), íŒ¨í„´ í•µì‹¬ì´ ì•„ë‹˜

---

### ğŸ“Œ í•µì‹¬ ì½”ë“œ 2 : ìƒíƒœ ì „í™˜ (TransitionTo)

**ìœ„ì¹˜ :** SimplePlayerStateMachine.cs:42-50

```csharp
public void TransitionTo(IState nextState)
{
    CurrentState.Exit();        // âœ… í•µì‹¬ 1 : í˜„ì¬ ìƒíƒœ ì •ë¦¬
    CurrentState = nextState;   // âœ… í•µì‹¬ 2 : ìƒíƒœ êµì²´
    nextState.Enter();          // âœ… í•µì‹¬ 3 : ìƒˆ ìƒíƒœ ì´ˆê¸°í™”

    // âœ… í•µì‹¬ 4 : ì˜µì €ë²„ íŒ¨í„´ìœ¼ë¡œ ì™¸ë¶€ì— ì•Œë¦¼
    stateChanged?.Invoke(nextState);
}
```

**ì´í•´ í¬ì¸íŠ¸ :**
- **Exit â†’ êµì²´ â†’ Enter** ìˆœì„œê°€ í•µì‹¬
- ìƒíƒœ ì „í™˜ ë¡œì§ì´ **í•œ ê³³ì— ì§‘ì¤‘** (ë¡œê·¸, ì¡°ê±´ ì¶”ê°€ ì‹œ ì—¬ê¸°ë§Œ ìˆ˜ì •)
- `stateChanged` ì´ë²¤íŠ¸ë¡œ PlayerStateView ë“± êµ¬ë…ìì—ê²Œ ì•Œë¦¼

---

### ğŸ“Œ í•µì‹¬ ì½”ë“œ 3 : ìƒíƒœë³„ ì „í™˜ ì¡°ê±´ (IdleState)

**ìœ„ì¹˜ :** IdleState.cs:28-41

```csharp
public void Execute()
{
    // âœ… ì¡°ê±´ 1 : ë°”ë‹¥ì— ë‹¿ì§€ ì•Šìœ¼ë©´ ì í”„ ìƒíƒœë¡œ ì „í™˜
    if (!player.IsGrounded)
    {
        player.PlayerStateMachine.TransitionTo(player.PlayerStateMachine.jumpState);
    }

    // âœ… ì¡°ê±´ 2 : ìµœì†Œ ì„ê³„ê°’ ì´ìƒìœ¼ë¡œ ì´ë™í•˜ë©´ ê±·ê¸° ìƒíƒœë¡œ ì „í™˜
    if (Mathf.Abs(player.CharController.velocity.x) > 0.1f ||
        Mathf.Abs(player.CharController.velocity.z) > 0.1f)
    {
        player.PlayerStateMachine.TransitionTo(player.PlayerStateMachine.walkState);
    }
}
```

**ì´í•´ í¬ì¸íŠ¸ :**
- ê° ìƒíƒœê°€ **ìì‹ ë§Œì˜ ì „í™˜ ì¡°ê±´**ì„ ê°€ì§
- `player` ì°¸ì¡°ë¥¼ í†µí•´ í•„ìš”í•œ ë°ì´í„°ì— ì ‘ê·¼
- `player.PlayerStateMachine`ì„ í†µí•´ ì „í™˜ ìš”ì²­ (ìˆœí™˜ ì°¸ì¡° êµ¬ì¡°)

---

### ğŸ“Œ í•µì‹¬ ì½”ë“œ 4 : ì˜µì €ë²„ íŒ¨í„´ ì—°ë™ (PlayerStateView)

**ìœ„ì¹˜ :** PlayerStateView.cs:22-51

ì´ í”„ë¡œì íŠ¸ì—ì„œ `stateChanged?.Invoke(nextState)`ê°€ í˜¸ì¶œë˜ë©´, ì´ë¥¼ **êµ¬ë…í•˜ê³  ìˆëŠ” `PlayerStateView`** ê°€ ë°˜ì‘í•©ë‹ˆë‹¤ :

```csharp
private void Awake()
{
    // âœ… í•µì‹¬ 1 : ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸ êµ¬ë…
    m_PlayerStateMachine.stateChanged += OnStateChanged;
}

void OnDestroy()
{
    // âœ… í•µì‹¬ 2 : êµ¬ë… í•´ì œ (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€)
    m_PlayerStateMachine.stateChanged -= OnStateChanged;
}

// âœ… í•µì‹¬ 3 : ìƒíƒœ ë³€ê²½ ì‹œ UI ì—…ë°ì´íŠ¸
private void OnStateChanged(IState state)
{
    m_LabelText.text  = state.GetType().Name;   // ìƒíƒœ ì´ë¦„ í‘œì‹œ
    m_LabelText.color = state.MeshColor;        // í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½
    ChangeMeshColor(state);                     // ë©”ì‹œ ìƒ‰ìƒ ë³€ê²½
}
```

**ì „ì²´ êµ¬ë… íë¦„ :**

```
â‘  StateMachineì—ì„œ ì´ë²¤íŠ¸ ì„ ì–¸
   public event Action<IState> stateChanged;
             â¬‡ï¸
â‘¡ PlayerStateViewê°€ Awakeì—ì„œ êµ¬ë… ë“±ë¡
   m_PlayerStateMachine.stateChanged += OnStateChanged;
             â¬‡ï¸
â‘¢ ìƒíƒœ ì „í™˜ ì‹œ Invoke ë°œë™
   stateChanged?.Invoke(nextState);
             â¬‡ï¸
â‘£ PlayerStateView.OnStateChanged() ìë™ ì‹¤í–‰
   â†’ UI í…ìŠ¤íŠ¸ ë³€ê²½, ë©”ì‹œ ìƒ‰ìƒ ë³€ê²½
```

**ì´í•´ í¬ì¸íŠ¸ :**
- StateMachineì€ **ëˆ„ê°€ ë“£ê³  ìˆëŠ”ì§€ ëª¨ë¦„** (ëŠìŠ¨í•œ ê²°í•©)
- State íŒ¨í„´ê³¼ Observer íŒ¨í„´ì´ **í•¨ê»˜ ì‚¬ìš©**ë˜ëŠ” ì¢‹ì€ ì˜ˆì‹œ
- ë‚˜ì¤‘ì— ì‚¬ìš´ë“œ ë§¤ë‹ˆì € ë“±ì„ ì¶”ê°€í•´ë„ StateMachine ì½”ë“œëŠ” **í•œ ì¤„ë„ ìˆ˜ì •í•  í•„ìš” ì—†ìŒ** :

```csharp
// StateMachine ì½”ë“œ ë³€ê²½ ì—†ì´, ì‚¬ìš´ë“œ ë§¤ë‹ˆì €ì—ì„œ êµ¬ë…ë§Œ ì¶”ê°€í•˜ë©´ ë¨
stateChanged += PlayStateSound;
```

---

## âš–ï¸ ì¥ë‹¨ì 

### âœ… ì¥ì 

**1. ê°œë°©-íì‡„ ì›ì¹™ (OCP) ì¤€ìˆ˜**
- ìƒˆë¡œìš´ ìƒíƒœ ì¶”ê°€ ì‹œ ìƒˆ í´ë˜ìŠ¤ë§Œ ìƒì„±
- ê¸°ì¡´ State ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”

**2. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (SRP) ì¤€ìˆ˜**
- ê° ìƒíƒœê°€ ìì‹ ì˜ ë¡œì§ë§Œ ë‹´ë‹¹
- ê¹”ë”í•œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬

**3. ìƒíƒœ ì „í™˜ ë¡œì§ ì§‘ì¤‘**
- TransitionTo ë©”ì„œë“œì—ì„œ ì „í™˜ì„ ì¤‘ì•™ ê´€ë¦¬
- Enter/Exit ì½œë°±ìœ¼ë¡œ ìƒíƒœ ì§„ì…/ì´íƒˆ ì‹œ ìë™ ì²˜ë¦¬

**4. ì¡°ê±´ë¬¸ ì œê±°**
- switch/if ì²´ì¸ ëŒ€ì‹  ë‹¤í˜•ì„± í™œìš©
- ì½”ë“œê°€ ê¹”ë”í•˜ê³  ê°€ë…ì„± í–¥ìƒ

**5. ë””ë²„ê¹… ìš©ì´**
- í˜„ì¬ ìƒíƒœê°€ ëª…í™•íˆ ê°ì²´ë¡œ ì¡´ì¬
- ìƒíƒœë³„ë¡œ ë¸Œë ˆì´í¬í¬ì¸íŠ¸ ì„¤ì • ê°€ëŠ¥

**6. ë‹¤ë¥¸ íŒ¨í„´ê³¼ ì¡°í•© ìš©ì´**
- Observer íŒ¨í„´ê³¼ ì¡°í•©í•˜ì—¬ ìƒíƒœ ë³€ê²½ ì•Œë¦¼
- Strategy íŒ¨í„´ê³¼ ìœ ì‚¬í•œ êµ¬ì¡°ë¡œ í™•ì¥ ê°€ëŠ¥

### âŒ ë‹¨ì 

**1. í´ë˜ìŠ¤ ìˆ˜ ì¦ê°€**
- ìƒíƒœ í•˜ë‚˜ë‹¹ í´ë˜ìŠ¤ í•˜ë‚˜ í•„ìš”
- ì†Œê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œëŠ” ê³¼ë„í•  ìˆ˜ ìˆìŒ

**2. ìƒíƒœ ê°„ ì˜ì¡´ì„±**
- ìƒíƒœë“¤ì´ ë‹¤ë¥¸ ìƒíƒœë¥¼ ì§ì ‘ ì°¸ì¡°í•´ì•¼ ì „í™˜ ê°€ëŠ¥
- StateMachineì„ í†µí•œ ì ‘ê·¼ì´ í•„ìš”

**3. ê°„ë‹¨í•œ ìƒíƒœì—ëŠ” ê³¼ë„í•¨**
- ìƒíƒœê°€ 2~3ê°œë¿ì´ë©´ switchë¬¸ì´ ë” ê°„ë‹¨í•  ìˆ˜ ìˆìŒ
- ìƒíƒœê°€ ë§ì•„ì§ˆ ë•Œ ì§„ê°€ë¥¼ ë°œíœ˜

**4. ì „í™˜ ë¡œì§ ë¶„ì‚°**
- ê° ìƒíƒœê°€ ìì‹ ì˜ ì „í™˜ ì¡°ê±´ì„ ê°€ì§
- ì „ì²´ ì „í™˜ ë¡œì§ì„ í•œëˆˆì— íŒŒì•…í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ

---

## ğŸ® ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€

### 1ï¸âƒ£ ì  AI

```csharp
// ì ì˜ ìƒíƒœë³„ í–‰ë™ ì •ì˜
public class PatrolState : IState
{
    public void Execute()
    {
        // ì •ì°° ê²½ë¡œë¥¼ ë”°ë¼ ì´ë™
        // í”Œë ˆì´ì–´ ë°œê²¬ ì‹œ â†’ ChaseStateë¡œ ì „í™˜
    }
}

public class ChaseState : IState
{
    public void Execute()
    {
        // í”Œë ˆì´ì–´ë¥¼ ì¶”ì 
        // ê³µê²© ë²”ìœ„ ì§„ì… ì‹œ â†’ AttackStateë¡œ ì „í™˜
        // í”Œë ˆì´ì–´ë¥¼ ë†“ì¹˜ë©´ â†’ PatrolStateë¡œ ë³µê·€
    }
}

public class AttackState : IState
{
    public void Execute()
    {
        // í”Œë ˆì´ì–´ ê³µê²©
        // ì²´ë ¥ 0 ì´í•˜ â†’ DeadStateë¡œ ì „í™˜
    }
}
```

### 2ï¸âƒ£ UI ì‹œìŠ¤í…œ

```csharp
// ê²Œì„ í™”ë©´ ìƒíƒœ ê´€ë¦¬
public class MainMenuState : IState { ... }
public class PlayingState  : IState { ... }
public class PausedState   : IState { ... }
public class GameOverState : IState { ... }

// StateMachineìœ¼ë¡œ í™”ë©´ ì „í™˜ ê´€ë¦¬
gameStateMachine.TransitionTo(pausedState);  // ì¼ì‹œì •ì§€
gameStateMachine.TransitionTo(playingState); // ê²Œì„ ì¬ê°œ
```

### 3ï¸âƒ£ ì• ë‹ˆë©”ì´ì…˜ ì‹œìŠ¤í…œ

```csharp
// Unityì˜ Animator Controllerê°€ ë°”ë¡œ State Pattern!
// Animatorì˜ State Machineê³¼ ë™ì¼í•œ ê°œë…
//
// Idle â†’ Walk â†’ Run â†’ Jump
//   â†‘                    â”‚
//   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ì‹¤ë¬´ í™•ì¥ ê°€ì´ë“œ

ì´ í”„ë¡œì íŠ¸ì˜ ì½”ë“œëŠ” **í•™ìŠµìš©ìœ¼ë¡œ ë‹¨ìˆœí•˜ê²Œ** ì„¤ê³„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. 

ì‹¤ë¬´ì—ì„œ ëª¬ìŠ¤í„°, NPC, ë³´ìŠ¤ ë“± ë‹¤ì–‘í•œ ì—”í‹°í‹°ì— ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì„ ì ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ì‚¬í•­ë“¤ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.

### í˜„ì¬ ì½”ë“œì˜ ì¬ì‚¬ìš©ì„± ë¶„ì„

í˜„ì¬ ì½”ë“œëŠ” **í”Œë ˆì´ì–´ ì „ìš©ìœ¼ë¡œ ê°•í•˜ê²Œ ê²°í•©**ë˜ì–´ ìˆìŠµë‹ˆë‹¤ :

| ìŠ¤í¬ë¦½íŠ¸ | ë‹¤ë¥¸ ì—”í‹°í‹°ì— ì¬ì‚¬ìš© ê°€ëŠ¥? | ì´ìœ  |
|---|---|---|
| `IState` ì¸í„°í˜ì´ìŠ¤ | âœ… ê°€ëŠ¥ | ë²”ìš©ì ì¸ Enter/Execute/Exit ì •ì˜ |
| `SimplePlayerStateMachine` | âŒ ë¶ˆê°€ | ìƒì„±ìê°€ `PlayerController`ë§Œ ë°›ìŒ |
| `IdleState / WalkState / JumpState` | âŒ ë¶ˆê°€ | ë‚´ë¶€ì—ì„œ `PlayerController`ì— ì§ì ‘ ì˜ì¡´ |

ì˜ˆë¥¼ ë“¤ì–´, ëª¬ìŠ¤í„°ë¥¼ ì¶”ê°€í•˜ë ¤ë©´ **IState ì¸í„°í˜ì´ìŠ¤ë§Œ ì¬ì‚¬ìš©**í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ìƒˆë¡œ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤ :

```
ëª¬ìŠ¤í„°ìš©ìœ¼ë¡œ ìƒˆë¡œ ë§Œë“¤ì–´ì•¼ í•  ê²ƒë“¤ :
â”œâ”€â”€ MonsterController.cs
â”œâ”€â”€ MonsterStateMachine.cs
â””â”€â”€ States/
    â”œâ”€â”€ MonsterPatrolState.cs
    â”œâ”€â”€ MonsterChaseState.cs
    â”œâ”€â”€ MonsterAttackState.cs
    â””â”€â”€ MonsterDeadState.cs
```

---

### ì œë„¤ë¦­ì„ í™œìš©í•œ ë²”ìš© StateMachine

ì‹¤ë¬´ì—ì„œëŠ” **ì œë„¤ë¦­**ì„ ì‚¬ìš©í•˜ì—¬ í•˜ë‚˜ì˜ StateMachine ì½”ë“œë¡œ ëª¨ë“  ì—”í‹°í‹°ì— ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ :

```csharp
// ë²”ìš© StateMachine
public class StateMachine<T>
{
    public IState CurrentState { get; private set; }
    public T      Owner        { get; private set; }  // Playerë“  Monsterë“  ê°€ëŠ¥

    public StateMachine(T owner)
    {
        this.Owner = owner;
    }

    public void TransitionTo(IState nextState)
    {
        CurrentState?.Exit();
        CurrentState = nextState;
        nextState.Enter();
    }
}
```

```csharp
// ì‚¬ìš© ì˜ˆì‹œ : íƒ€ì…ë§Œ ë°”ê¾¸ë©´ ì–´ë””ì—ë“  ì ìš© ê°€ëŠ¥
StateMachine<PlayerController>  playerSM  = new(playerController);
StateMachine<MonsterController> monsterSM = new(monsterController);
StateMachine<BossController>    bossSM    = new(bossController);
```

ì´ë ‡ê²Œ í•˜ë©´ StateMachineì€ **í•œ ë²ˆë§Œ ì‘ì„±**í•˜ê³ , ê° ì—”í‹°í‹°ì˜ State í´ë˜ìŠ¤ë§Œ ìƒˆë¡œ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤.

---

### ì»¨íŠ¸ë¡¤ëŸ¬ì™€ StateMachineì˜ 1:1 ê´€ê³„

ê° StateMachineì€ **"ë‚´ê°€ ëˆ„êµ¬ì˜ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ”ì§€"** ì•Œì•„ì•¼ í•˜ë¯€ë¡œ, **ì»¨íŠ¸ë¡¤ëŸ¬ 1ê°œ = StateMachine 1ê°œ**ì˜ 1:1 ê´€ê³„ê°€ ê¸°ë³¸ì…ë‹ˆë‹¤ :

```
PlayerController    â”€â”€â”€â”€ 1:1 â”€â”€â”€â”€  PlayerStateMachine
MonsterController   â”€â”€â”€â”€ 1:1 â”€â”€â”€â”€  MonsterStateMachine
BossController      â”€â”€â”€â”€ 1:1 â”€â”€â”€â”€  BossStateMachine
```

ê°™ì€ íƒ€ì…ì˜ ê°ì²´ê°€ ì—¬ëŸ¬ ê°œ ìˆì–´ë„, ê°ê° **ë…ë¦½ì ì¸ StateMachine**ì„ ì†Œìœ í•©ë‹ˆë‹¤ :

```
ìŠ¬ë¼ì„ A â”€â”€â”€â”€ StateMachine (ì§€ê¸ˆ : Patrol)
ìŠ¬ë¼ì„ B â”€â”€â”€â”€ StateMachine (ì§€ê¸ˆ : Chase)    â† ê°™ì€ ìŠ¬ë¼ì„ì´ì–´ë„ ê°ê° ë”°ë¡œ!
ìŠ¬ë¼ì„ C â”€â”€â”€â”€ StateMachine (ì§€ê¸ˆ : Dead)
```

ìŠ¬ë¼ì„ 100ë§ˆë¦¬ê°€ ìˆìœ¼ë©´, **StateMachineë„ 100ê°œ**ê°€ ìƒê¹ë‹ˆë‹¤.

---

### State ì¸ìŠ¤í„´ìŠ¤ ìµœì í™” (Flyweight ë°©ì‹)

ì§€ê¸ˆ ì˜ˆì œì—ì„œëŠ” Stateë§ˆë‹¤ `new`ë¡œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì§€ë§Œ, **Stateê°€ ìì²´ì ì¸ ìƒíƒœê°’ì„ ë“¤ê³  ìˆì§€ ì•Šë‹¤ë©´** í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì—¬ëŸ¬ StateMachineì´ ê³µìœ í•˜ëŠ” **Flyweight** ë°©ì‹ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤ :

```csharp
// Flyweight ë°©ì‹ : State ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ 
public static class SharedStates
{
    public static readonly PatrolState Patrol = new();
    public static readonly ChaseState  Chase  = new();
    public static readonly DeadState   Dead   = new();
}

// ìŠ¬ë¼ì„ 100ë§ˆë¦¬ê°€ ìˆì–´ë„ State ì¸ìŠ¤í„´ìŠ¤ëŠ” 3ê°œë§Œ ì¡´ì¬
slimeA.StateMachine.TransitionTo(SharedStates.Chase);
slimeB.StateMachine.TransitionTo(SharedStates.Chase);  // ê°™ì€ ì¸ìŠ¤í„´ìŠ¤!
```

âš ï¸âš ï¸âš ï¸ ë‹¨, State ë‚´ë¶€ì— ê°œë³„ ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤. ê³µìœ  StateëŠ” **ìˆœìˆ˜í•˜ê²Œ í–‰ë™ ë¡œì§ë§Œ** ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤.

---

## ğŸ“ í•™ìŠµ ì •ë¦¬

### í•µì‹¬ ê°œë…

**ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì˜ ë³¸ì§ˆ :**
```
ê°ì²´ì˜ ìƒíƒœë¥¼ ë³„ë„ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬í•˜ì—¬
ìƒíƒœ ì „í™˜ ì‹œ í–‰ë™ì´ ìë™ìœ¼ë¡œ ë°”ë€Œê²Œ í•˜ëŠ” íŒ¨í„´
```

### ì£¼ìš” êµ¬ì„± ìš”ì†Œ

```
IState (ì¸í„°í˜ì´ìŠ¤)
  â†“
  Enter() / Execute() / Exit()

Concrete States (êµ¬ì²´ ìƒíƒœ)
  â†“
  IdleState / WalkState / JumpState

StateMachine (ìƒíƒœ ë¨¸ì‹ )
  â†“
  Initialize() / TransitionTo() / Execute()

Context (ì†Œìœ ì)
  â†“
  PlayerController â†’ StateMachine ì†Œìœ  ë° ì—…ë°ì´íŠ¸
```

### ìƒíƒœ ì „í™˜ ìƒëª…ì£¼ê¸°

```
í˜„ì¬ ìƒíƒœ.Exit() â†’ ìƒíƒœ êµì²´ â†’ ìƒˆ ìƒíƒœ.Enter() â†’ ì´ë²¤íŠ¸ ì•Œë¦¼
```

### ì–¸ì œ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?

**âœ… ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ ì¢‹ì€ ê²½ìš° :**
- ê°ì²´ê°€ **ì—¬ëŸ¬ ìƒíƒœ**ë¥¼ ê°€ì§€ê³ , ìƒíƒœì— ë”°ë¼ **í–‰ë™ì´ ë‹¬ë¼ì§ˆ ë•Œ**
- ìƒíƒœê°€ **3ê°œ ì´ìƒ**ìœ¼ë¡œ ë³µì¡í•œ ì „í™˜ ë¡œì§ì´ í•„ìš”í•  ë•Œ
- ìƒíƒœë³„ ë¡œì§ì´ **ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬**ë˜ì–´ì•¼ í•  ë•Œ
- AI, ìºë¦­í„°, UI í™”ë©´ ì „í™˜ ë“±

**âŒ ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì„ í”¼í•´ì•¼ í•˜ëŠ” ê²½ìš° :**
- ìƒíƒœê°€ 2ê°œ ì´í•˜ì¸ ê°„ë‹¨í•œ ê²½ìš° (boolì´ ë” íš¨ìœ¨ì )
- ìƒíƒœ ì „í™˜ì´ ê±°ì˜ ì—†ëŠ” ê²½ìš°
- ìƒíƒœë³„ í–‰ë™ ì°¨ì´ê°€ ë¯¸ë¯¸í•œ ê²½ìš°

### ê´€ë ¨ íŒ¨í„´

| íŒ¨í„´ | ê´€ê³„ |
|------|------|
| **Observer** | StateMachineì˜ ìƒíƒœ ë³€ê²½ì„ ì™¸ë¶€ì— ì•Œë¦´ ë•Œ í•¨ê»˜ ì‚¬ìš© |
| **Strategy** | êµ¬ì¡°ê°€ ìœ ì‚¬í•˜ì§€ë§Œ, StrategyëŠ” ì•Œê³ ë¦¬ì¦˜ êµì²´, StateëŠ” ìƒíƒœ ê¸°ë°˜ í–‰ë™ ë³€ê²½ |
| **Flyweight** | State ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•˜ì—¬ ë©”ëª¨ë¦¬ ìµœì í™” ê°€ëŠ¥ |

### ë§ˆë¬´ë¦¬

ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì€ **ê²Œì„ ê°œë°œì—ì„œ ê°€ì¥ ë¹ˆë²ˆí•˜ê²Œ ì‚¬ìš©ë˜ëŠ” íŒ¨í„´** ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.

**ê¸°ì–µí•  ì  :**
- âœ… ìƒíƒœë³„ ë¡œì§ì„ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬í•˜ì—¬ ê¹”ë”í•œ ì½”ë“œ
- âœ… Enter/Execute/Exit ìƒëª…ì£¼ê¸°ë¡œ ì•ˆì „í•œ ìƒíƒœ ì „í™˜
- âœ… Observer íŒ¨í„´ê³¼ ì¡°í•©í•˜ì—¬ ìƒíƒœ ë³€ê²½ ì•Œë¦¼
- âš ï¸ ì‹¤ë¬´ì—ì„œëŠ” ì œë„¤ë¦­ì„ í™œìš©í•˜ì—¬ ë²”ìš© StateMachine êµ¬ì¶• ê¶Œì¥
- ğŸ¯ Unityì˜ Animator Controllerê°€ ë°”ë¡œ State Patternì˜ ì‹¤ì œ êµ¬í˜„ ì‚¬ë¡€

---

**ì‘ì„±ì¼ :** 2026.01.31
**ì°¸ê³  ìë£Œ :** Unity Korea - Level Up Your Code with Design Patterns and SOLID
